{% extends "base.html" %}

{% block content %}
<!-- Hero Section -->
<div class="text-center py-12 mb-10">
    <h1 class="text-4xl font-bold text-white mb-3">Jukebox</h1>
    <p class="text-lg text-muted mb-8">Create and share your music lists. Discover what others are listening to.</p>

    {% if not session.user %}
    <div class="flex justify-center gap-4">
        <a href="{{ url_for('signup') }}" class="btn-primary">Get Started</a>
        <a href="{{ url_for('login') }}" class="btn-secondary">Sign In</a>
    </div>
    {% endif %}
</div>

<!-- User Search -->
<div class="max-w-xl mx-auto mb-12">
    <form method="GET" action="{{ url_for('search_users') }}" class="flex gap-3">
        <input type="text" name="q" placeholder="Search for users..." class="input-field flex-1">
        <button type="submit" class="btn-primary">Search</button>
    </form>
</div>

<!-- Popular Lists -->
{% if public_lists %}
<div>
    <h2 class="text-sm font-semibold text-muted uppercase tracking-wider mb-5">Recent Public Lists</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">
        {% for list in public_lists %}
        <a href="{{ url_for('view_list', list_id=list.id) }}" class="card p-5 hover:border-accent transition block">
            <!-- Album art preview -->
            {% if list.preview_images %}
            <div class="flex gap-1 mb-4">
                {% for img in list.preview_images[:4] %}
                <div class="w-12 h-12 rounded overflow-hidden bg-elevated">
                    <img src="{{ img }}" alt="" class="w-full h-full object-cover">
                </div>
                {% endfor %}
                {% if list.item_count > 4 %}
                <div class="w-12 h-12 rounded bg-elevated flex items-center justify-center">
                    <span class="text-muted text-xs font-medium">+{{ list.item_count - 4 }}</span>
                </div>
                {% endif %}
            </div>
            {% else %}
            <div class="flex gap-1 mb-4">
                <div class="w-12 h-12 rounded bg-elevated flex items-center justify-center">
                    <span class="text-muted text-lg">♪</span>
                </div>
            </div>
            {% endif %}

            <h3 class="font-semibold text-white leading-tight">{{ list.title }}</h3>
            <p class="text-xs text-muted mt-1">
                by <span class="text-accent">{{ list.profiles.username if list.profiles else 'Unknown' }}</span>
            </p>
            {% if list.description %}
            <p class="text-sm text-muted mt-2 line-clamp-2">{{ list.description[:80] }}{% if list.description|length > 80 %}...{% endif %}</p>
            {% endif %}
            <p class="text-xs text-muted mt-3">
                {{ list.item_count }} song{{ 's' if list.item_count != 1 else '' }} · {{ 'Ranked' if list.is_ranked else 'Unranked' }}
            </p>
        </a>
        {% endfor %}
    </div>
</div>
{% else %}
<div class="card text-center py-12 px-6">
    <p class="text-muted">No public lists yet. Be the first to create one!</p>
    {% if session.user %}
    <a href="{{ url_for('create_list') }}" class="btn-primary mt-4 inline-block">Create a List</a>
    {% endif %}
</div>
{% endif %}
{% endblock %}
